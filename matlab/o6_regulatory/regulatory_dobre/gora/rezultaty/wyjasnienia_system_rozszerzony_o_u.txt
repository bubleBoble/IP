% lqr dla systemu rozszerzonego nr.2 (rozpisane na kartce)
% sygnał wejsciowy wprowadzony w zmienną stanu
% cel: chcę kontrolować szybkość narastania wartości sygnału sterującego
% 	   przez macierz R w LQR
% po co: aby sygnał sterujący nie był zbyt agresywny - pośrednio wpływa się też na wyższe pochodne innych zmiennych
		 np. na przyśpieszenie wózka

% wcześniejsza kara za u wchodzi w macierz Q (dokładnie w Q(5))
% teraz R jest karą za pochodną u

% czyli dla R=0(0.001) i Q(5)=1 regulator jest równoważny do 
% normalnego LQR z systemu nie rozszerzonego 
% [!] R nie może być całkowicie zero bo:
%          Error using lqr
%          Cannot compute the stabilizing Riccati solution S for the LQR design.
%          This could be because:
%            * (A,E) has imaginary-axis or unit-circle modes that are not controllable through B,
%            * R is singular,
%            * [Q N;N' R] needs to be positive definite,
%            * The E matrix in the state equation is singular.
% [!] wyniki:
%         zgadza się
% [!] ważne:
%         dodać w simulinku v jako piąty  stan

% wyjście ze wzmocnienia -Fa w simulinku jest całkowane bo
% LQR z systemu z dodanym u jako zmienną stanu wyznacza pochodną u jako sterowanie